<!DOCTYPE html>
<html lang="en">
<head>
  <title>Darchei.tech Homepage</title>
  <style>
    body {
      background: linear-gradient(45deg, lightpink, lightgreen, lightblue);
      font-family: Arial, sans-serif;
      padding: 25px;
      text-align: center;
    }
    #content {
      background-color: white;
      border-radius: 15px;
      padding: 25px;
      box-shadow: 0 4px 6px rgba(0,0,0,0.15);
      display: inline-block;
      max-width: 600px;
    }
    input, button {
      padding: 10px;
      margin-top: 15px;
      border-radius: 12px;
      border: 1px solid #ccc;
      width: 80%;
    }
    button {
      background-color: yellow;
      cursor: pointer;
    }
  </style>
</head>
<body>

<div id="content">Loading...</div>

<script>
async function loadContent(inviteCode) {
  const jsonUrl = 'https://raw.githubusercontent.com/shimonkolodny/Backup-html/main/Darchei.tech/links.json';

  try {
    const codesRes = await fetch(jsonUrl);
    if (!codesRes.ok) throw new Error('Could not load invite links.');

    const codes = await codesRes.json();
    const htmlUrl = codes[inviteCode];

    if (!htmlUrl) {
      document.getElementById('content').innerHTML = "<h2>Invite code invalid.</h2>";
      return;
    }

    const htmlRes = await fetch(htmlUrl);
    if (!htmlRes.ok) throw new Error('Could not fetch content.');

    const html = await htmlRes.text();
    document.getElementById('content').innerHTML = html;

  } catch (e) {
    document.getElementById('content').innerHTML = `<h2>Error:</h2><p>${e.message}</p>`;
  }
}

function askForCode() {
  document.getElementById('content').innerHTML = `
    <h3>Please enter your invite code or full invite link:</h3>
    <input id="codeInput" placeholder="Invite code or full link">
    <br><button onclick="submitCode()">Load Content</button>
  `;
}

function submitCode() {
  let input = document.getElementById('codeInput').value.trim();
  let inviteCode = input;

  if(input.includes("?code=")){
    inviteCode = new URL(input).searchParams.get('code');
  }

  if(inviteCode){
    loadContent(inviteCode);
  } else {
    alert('Please enter a valid code or link.');
  }
}

window.onload = function(){
  const params = new URLSearchParams(location.search);
  let code = params.get('code');

  if (!code) askForCode();
  else loadContent(code);
};
</script>

</body>
</html>
